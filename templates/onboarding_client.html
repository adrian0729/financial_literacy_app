<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Client Onboarding</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet" />
    <style>
      :root {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        color: #0f172a;
        background: #f8fafc;
        --accent: #16a34a;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        min-height: 100vh;
        background: #f8fafc;
        display: flex;
        justify-content: center;
        padding: 2.5rem 1rem;
      }
      .shell {
        width: 100%;
        max-width: 1080px;
        background: #fff;
        border: 1px solid #e2e8f0;
        border-radius: 16px;
        display: grid;
        grid-template-columns: 280px 1fr;
        box-shadow: 0 15px 50px rgba(15, 23, 42, 0.08);
      }
      .steps {
        padding: 2rem 1.5rem;
        border-right: 1px solid #e2e8f0;
        background: linear-gradient(180deg, #f1f5f9 0%, #ffffff 100%);
      }
      .steps h2 {
        margin: 0 0 1rem;
        font-size: 1.1rem;
        color: #0f172a;
      }
      .step {
        display: flex;
        gap: 0.75rem;
        align-items: center;
        padding: 0.8rem 0.6rem;
        border-radius: 10px;
        color: #0f172a;
      }
      .step .dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        border: 2px solid #cbd5e1;
      }
      .step.active {
        background: rgba(22, 163, 74, 0.12);
        color: #0f172a;
        font-weight: 600;
      }
      .step.active .dot {
        border-color: var(--accent);
        background: var(--accent);
      }
      .content {
        padding: 2rem 2.5rem;
      }
      h1 {
        margin: 0;
        font-size: 1.75rem;
      }
      p {
        margin: 0.4rem 0 1.2rem;
        color: #475569;
      }
      form {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 1rem 1.25rem;
      }
      label {
        display: block;
        font-size: 0.95rem;
        font-weight: 600;
        color: #0f172a;
        margin-bottom: 0.35rem;
      }
      input,
      select,
      textarea {
        width: 100%;
        border: 1px solid #cbd5e1;
        border-radius: 10px;
        padding: 0.8rem 0.9rem;
        font-size: 1rem;
        background: #fff;
        color: #0f172a;
      }
      textarea {
        min-height: 100px;
        resize: vertical;
      }
      .radio-row {
        display: flex;
        gap: 1rem;
      }
      .checkbox-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }
      .footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1.25rem;
        grid-column: 1 / -1;
      }
      .muted {
        color: #64748b;
        font-size: 0.95rem;
      }
      button {
        border: none;
        border-radius: 12px;
        padding: 0.85rem 1.4rem;
        font-size: 1rem;
        cursor: pointer;
        background: var(--accent);
        color: #fff;
      }
      .backlink {
        color: #0f172a;
        text-decoration: none;
        font-weight: 600;
      }
      @media (max-width: 900px) {
        .shell {
          grid-template-columns: 1fr;
        }
        .steps {
          border-right: none;
          border-bottom: 1px solid #e2e8f0;
        }
      }
    </style>
  </head>
  <body>
    <div class="shell">
      <aside class="steps">
        <h2>Setup checklist</h2>
        <div class="step {% if step == 1 %}active{% endif %}"><span class="dot"></span>Contact</div>
        <div class="step {% if step == 2 %}active{% endif %}"><span class="dot"></span>Industry</div>
        <div class="step {% if step == 3 %}active{% endif %}"><span class="dot"></span>Team & revenue</div>
        <div class="step {% if step == 4 %}active{% endif %}"><span class="dot"></span>E-commerce</div>
        <div class="step {% if step == 5 %}active{% endif %}"><span class="dot"></span>Funding</div>
        <div class="step {% if step == 6 %}active{% endif %}"><span class="dot"></span>Goals</div>
        <div class="step {% if step == 7 %}active{% endif %}"><span class="dot"></span>Address</div>
        <div class="step {% if step == 8 %}active{% endif %}"><span class="dot"></span>Region</div>
      </aside>
      <main class="content">
        <h1>Welcome{% if client_profile %}, {{ client_profile.contact_name or client_profile.contact_phone or '' }}{% endif %}</h1>
        <p>Tell us a bit about your company so we can tailor your metrics and guidance.</p>

        <form method="post" action="/onboarding/client" id="onboardingForm">
          <input type="hidden" name="step" value="{{ step }}" />
          <input type="hidden" name="funding" id="fundingInput" />

          {% if step == 1 %}
          <div>
            <label for="contact_name">Primary contact</label>
            <input id="contact_name" name="contact_name" value="{{ data.contact_name or (client_profile.contact_name if client_profile else '') }}" required />
          </div>
          <div>
            <label for="phone">Phone</label>
            <input id="phone" name="phone" value="{{ data.phone or (client_profile.phone if client_profile else '') }}" />
          </div>
          {% elif step == 2 %}
          <div>
            <label for="industry">Industry</label>
            <input id="industry" name="industry" value="{{ data.industry or (client_profile.industry if client_profile else '') }}" placeholder="e.g., SaaS, eCommerce, Services" />
          </div>
          {% elif step == 3 %}
          <div>
            <label for="employees">Team size</label>
            <select id="employees" name="employees">
              {% set emp = data.employees or '' %}
              {% for option in ['1-4','5-20','21-50','51-100','101-500','500+'] %}
              <option value="{{ option }}" {% if emp == option %}selected{% endif %}>{{ option }}</option>
              {% endfor %}
            </select>
          </div>
          <div>
            <label for="revenue">Monthly revenue</label>
            <select id="revenue" name="revenue">
              {% set rev = data.revenue or '' %}
              {% for option in ['< $50k','$50k - $100k','$100k - $250k','$250k - $500k','$500k - $1M','$1M+'] %}
              <option value="{{ option }}" {% if rev == option %}selected{% endif %}>{{ option }}</option>
              {% endfor %}
            </select>
          </div>
          {% elif step == 4 %}
          <div>
            <label>E-commerce?</label>
            <div class="radio-row">
              {% set eco = data.ecommerce or '' %}
              <label><input type="radio" name="ecommerce" value="yes" {% if eco == 'yes' %}checked{% endif %}/> Yes</label>
              <label><input type="radio" name="ecommerce" value="no" {% if eco == 'no' %}checked{% endif %}/> No</label>
            </div>
          </div>
          {% elif step == 5 %}
          <div class="checkbox-group">
            <label>Funding sources (select all that apply)</label>
            {% set funding_set = (data.funding or '') %}
            {% for option in ['Angel/Seed','VC/Growth','Revenue funded','Debt/Loan','Bootstrapped'] %}
            <label><input type="checkbox" class="funding-box" value="{{ option }}" {% if option in funding_set %}checked{% endif %}/> {{ option }}</label>
            {% endfor %}
          </div>
          {% elif step == 6 %}
          <div>
            <label for="intent">Whatâ€™s your primary goal?</label>
            <select id="intent" name="intent">
              {% set intent_val = data.intent or '' %}
              {% for option in ['Cash visibility','Board reporting','Fundraising prep','Lender package','Tax prep'] %}
              <option value="{{ option }}" {% if intent_val == option %}selected{% endif %}>{{ option }}</option>
              {% endfor %}
              <option value="Other" {% if intent_val == 'Other' %}selected{% endif %}>Other</option>
            </select>
          </div>
          <div style="grid-column:1/-1">
            <label for="notes">Anything else we should know? (optional)</label>
            <textarea id="notes" name="intent_extra" placeholder="Key tools, banks, pain points">{{ data.intent_extra or '' }}</textarea>
          </div>
          {% elif step == 7 %}
          <div>
            <label for="address_line">Address line</label>
            <input id="address_line" name="address_line" value="{{ data.address_line or (client_profile.address_line if client_profile else '') }}" />
          </div>
          <div>
            <label for="city">City</label>
            <input id="city" name="city" value="{{ data.city or (client_profile.city if client_profile else '') }}" />
          </div>
          {% elif step == 8 %}
          <div>
            <label for="state">State/Province</label>
            <input id="state" name="state" value="{{ data.state or (client_profile.state if client_profile else '') }}" />
          </div>
          <div>
            <label for="postal_code">Postal code</label>
            <input id="postal_code" name="postal_code" value="{{ data.postal_code or (client_profile.postal_code if client_profile else '') }}" />
          </div>
          {% endif %}

          <div class="footer">
            <a class="backlink" href="/logout">Sign out</a>
            <div class="muted">Step {{ step }} of 8</div>
            <button type="submit">{{ 'Next' if step < 8 else 'Finish setup' }}</button>
          </div>
        </form>
      </main>
    </div>
    <script>
      const fundingBoxes = document.querySelectorAll(".funding-box");
      const fundingInput = document.getElementById("fundingInput");
      const form = document.getElementById("onboardingForm");
      if (form && fundingInput) {
        const setFunding = () => {
          const values = Array.from(fundingBoxes)
            .filter((el) => el.checked)
            .map((el) => el.value);
          fundingInput.value = values.join(", ");
        };
        fundingBoxes.forEach((el) => el.addEventListener("change", setFunding));
        form.addEventListener("submit", setFunding);
      }
    </script>
  </body>
</html>
